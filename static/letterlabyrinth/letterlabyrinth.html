<!DOCTYPE html>
<html>
<title>Letter Labyrinth</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!--
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-blue.css">
-->
<link rel="stylesheet" href="./css/w3.css">
<link rel="stylesheet" href="./css/w3-theme-blue.css">

<style>
	html,
	body,
	h1,
	h2,
	h3,
	h4,
	h5,
	h6 {
		font-family: Arial, Helvetica, sans-serif;
		font-size: 18px;
	}
</style>

<!--
<script src="https://unpkg.com/jspdf@latest/dist/jspdf.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.js"></script>
-->

<script type="text/javascript" src="./js/jspdf.min.js"></script>
<script type="text/javascript" src="./js/pdfobject.js"></script>


<script type="text/javascript">
	//doResize();
	function doResize() {
		document.getElementById("id-header-placeholder").style.height = document.getElementById("id-header").offsetHeight + "px";
		document.getElementById("id-footer-placeholder").style.height = document.getElementById("id-footer").offsetHeight + "px";
		document.getElementById("id-main").style.height = window.innerHeight - document.getElementById("id-header").offsetHeight - document.getElementById("id-footer").offsetHeight + "px";
		document.getElementById("pdfpreview").style.height = document.getElementById("id-main").offsetHeight - 50 + "px";
		document.getElementById("pdfpreview").style.width = document.getElementById("pdfpreview").offsetHeight * 0.63 + "px";
	};
	function doOnLoad() {
		doResize();
		doTest();
		//PDFObject.embed("./document.pdf", "#pdfpreview");
	};
	window.addEventListener("resize", doResize);
	window.addEventListener("load", doOnLoad);
</script>


<script type="text/javascript" src="./js/letterlabyrinth.js"></script>

<script type="text/javascript">
	function doPdfPreview() {
		let doc = new jsPDF();

		let fontsize = 16;
		doc.setFont("helvetica");
		doc.setFontSize(fontsize);
		doc.setLineWidth(0.1);

		let m = getLastMatrix();

		let ms = parseInt(document.getElementById("select_matrix_size").value);
		let width = 80;
		let cellwidth = width / ms;
		let x = 55 - (width / 2);
		let y = 52 - (width / 2);
		
		let startCell = getStartCell();
		let endCell = getEndCell();

		for(let iRow=0; iRow<m.length; iRow++){
			//let s = '[' + m[iRow].join('][') + ']';
			//doc.text(s, 15, 20 + 7 * iRow);
			doc.line(x, y + cellwidth * iRow, x + width, y + cellwidth * iRow);
			let mr = m[iRow];
			for(let iCol=0;iCol<mr.length; iCol++){
				if(iRow == 0){
					doc.line(x + cellwidth * iCol, y, x + cellwidth * iCol, y + width);
				}
				if((startCell.row == iRow && startCell.col == iCol) || (endCell.row == iRow && endCell.col == iCol)){
					doc.setFillColor(208);
					doc.rect(x + cellwidth * iCol + 1, y + cellwidth * iRow + 1, cellwidth - 2, cellwidth - 2, "F");
				}
				doc.text(m[iRow][iCol].toLowerCase(), x + cellwidth * iCol + cellwidth / 2 - 2, y + cellwidth * iRow + cellwidth / 2 + 1);
			}
		}
		doc.line(x, y + cellwidth * m.length, x + width, y + cellwidth * m.length);
		doc.line(x + cellwidth * m.length, y, x + cellwidth * m.length, y + width);
		
		// doc.line(5, 5, 205, 5); //top
		// doc.line(205, 5, 205, 292); //right
		// doc.line(5, 5, 5, 292); //left
		// doc.line(5, 292, 205, 292); //bottom

		// doc.line(5, 100, 205, 100); //third
		// doc.line(5, 196, 205, 196); //two third
		// doc.line(105, 5, 105, 292); //half


		//doc.text("PDF test", 35, 25);

		//doc.line(20, 20, 60, 20); // horizontal line

// doc.setLineWidth(0.5);
// doc.line(20, 25, 60, 25);

// doc.setLineWidth(1);
// doc.line(20, 30, 60, 30);

// doc.setLineWidth(1.5);
// doc.line(20, 35, 60, 35);

// doc.setDrawColor(255, 0, 0); // draw red lines

// doc.setLineWidth(0.1);
// doc.line(100, 20, 100, 60); // vertical line

// doc.setLineWidth(0.5);
// doc.line(105, 20, 105, 60);

// doc.setLineWidth(1);
// doc.line(110, 20, 110, 60);

// doc.setLineWidth(1.5);
// doc.line(115, 20, 115, 60);

// doc.text(10, 110, "setLineDash");

// doc.setLineWidth(0.1);
// doc.setDrawColor(0, 0, 0);

// doc.setLineDash([2.5]);
// doc.line(10, 120, 200, 120);

// doc.setLineDash([1, 1.5, 1, 1.5, 1, 1.5, 3, 2, 3, 2, 3, 2]);
// doc.line(10, 125, 200, 125);

// doc.setLineDash([1, 1.5, 1, 1.5, 1, 1.5, 3, 2, 3, 2, 3, 2], 7.5);
// doc.line(10, 130, 200, 130); 		


		PDFObject.embed(doc.output("bloburl"), "#pdfpreview");
	}
	function doTheJob() {
		let ms = parseInt(document.getElementById("select_matrix_size").value);
		let ch = document.getElementById("select_characters").value;
		let cs = parseInt(document.getElementById("select_cellsize").value);
		let highlight = document.getElementById("chk_highlight").checked;
		document.getElementById("placeofthematrix").innerHTML = generateHTML(ms, ms, ch, cs, highlight);
		doPdfPreview();
		document.getElementById("placeofthemessage").innerHTML = '&nbsp;';
		document.getElementById("placeofthemessage").disabled = false;
	}
	function doTest() {
		document.getElementById("placeofthemessage").disabled = true;
		let ms = parseInt(document.getElementById("select_matrix_size").value);
		let cs = parseInt(document.getElementById("select_cellsize").value);
		document.getElementById("placeofthematrix").innerHTML = generateEmptyHTML(ms, ms, cs);
		document.getElementById("id_cell_container").style.width = '' + (cs * ms + 83) + 'px';
		document.getElementById("placeofthemessage").innerHTML = 'Please wait ...';
		setTimeout(() => doTheJob(), 100);
	};
	function doOnChangeMatrixSize() {
		let ms = parseInt(document.getElementById("select_matrix_size").value);
		let cs = parseInt(document.getElementById("select_cellsize").value);
		document.getElementById("placeofthematrix").innerHTML = generateEmptyHTML(ms, ms, cs);
		document.getElementById("id_cell_container").style.width = '' + (cs * ms + 83) + 'px';
	};
	function doOnChangeCharacters() {
		let ms = parseInt(document.getElementById("select_matrix_size").value);
		let cs = parseInt(document.getElementById("select_cellsize").value);
		document.getElementById("placeofthematrix").innerHTML = generateEmptyHTML(ms, ms, cs);
		//document.getElementById("id_cell_container").style.width = '' + (cs * ms + 83) + 'px';
	};
	function doOnChangeCellsize() {
		let ms = parseInt(document.getElementById("select_matrix_size").value);
		let cs = parseInt(document.getElementById("select_cellsize").value);
		let highlight = document.getElementById("chk_highlight").checked;
		document.getElementById("placeofthematrix").innerHTML = getLastMatrixHTML(cs, highlight);
		document.getElementById("id_cell_container").style.width = '' + (cs * ms + 83) + 'px';
	};
	function doOnChangeHighlight() {
		let cs = parseInt(document.getElementById("select_cellsize").value);
		let highlight = document.getElementById("chk_highlight").checked;
		document.getElementById("placeofthematrix").innerHTML = getLastMatrixHTML(cs, highlight);
	};
</script>

<body class="w3-theme-l5">

	<!--<header class="w3-container w3-light-blue w3-top">-->
	<header class="w3-container w3-theme-l3 w3-top" id="id-header">
		<!--<div class="w3-bar w3-black">
    <a href="#" class="w3-bar-item w3-button">Home</a>
    <a href="#" class="w3-bar-item w3-button">Link 1</a>
    <a href="#" class="w3-bar-item w3-button">Link 2</a>
    <a href="#" class="w3-bar-item w3-button">Link 3</a>
</div>-->

		<div class="w3-bar w3-theme-l3">

			<span class="w3-bar-item w3-text-indigo w3-left" style="padding-right:0px; padding-left:0px;">
				<div
					style="width: 27px; height: 27px; background: repeating-linear-gradient(135deg, white 0px, white 19px, orange 19px, orange 38px);">
				</div>
			</span>

			<span class="w3-bar-item w3-text-indigo w3-left">Letter Labyrinth</span>
			<!--
  <a href="#" class="w3-bar-item w3-button w3-text-indigo w3-hover-blue w3-text-pink">Home</a>
  <a href="#" class="w3-bar-item w3-button w3-text-indigo w3-hover-blue">Link 1</a>
  <a href="#" class="w3-bar-item w3-button w3-text-indigo w3-hover-blue">Link 2</a>
  <a href="#" class="w3-bar-item w3-button w3-text-indigo w3-hover-blue">Link 3</a>
  <div class="w3-dropdown-hover">
    <button class="w3-button w3-text-indigo w3-theme-l3 w3-hover-blue">Dropdown</button>
    <div class="w3-dropdown-content w3-bar-block w3-card-4 w3-theme-l3">
      <a href="#" class="w3-bar-item w3-button w3-text-indigo w3-hover-blue">Link 11</a>
      <a href="#" class="w3-bar-item w3-button w3-text-indigo w3-hover-blue">Link 12</a>
      <a href="#" class="w3-bar-item w3-button w3-text-indigo w3-hover-blue">Link 13</a>
    </div>
  </div>
  <span class="w3-bar-item w3-text-indigo w3-right">Text</span>
  -->
		</div>

	</header>


	<div class="w3-container" id="id-header-placeholder">
		<p>&nbsp;</p>
	</div>


	<div class="w3-display-container w3-theme-l4" style="overflow:auto; width:100%;" id="id-main">

		<div class="w3-row-padding">

			<div class="w3-col s12 m4 l2 w3-center w3-padding">

				<div class="w3-card-4 w3-theme-l2 w3-padding w3-round-large">
					<label class="w3-left w3-text-indigo">Matrix size:</label>
					<select class="w3-select w3-margin-bottom" id="select_matrix_size"
						onchange="doOnChangeMatrixSize();">
						<option value="7">7 x 7</option>
						<option value="8">8 x 8</option>
						<option value="9" selected>9 x 9</option>
					</select>

					<label class="w3-left w3-text-indigo">Characters:</label>
					<select class="w3-select w3-margin-bottom" id="select_characters" onchange="doOnChangeCharacters();">
						<option value="xo">X | O</option>
						<option value="pb">p | b</option>
						<option value="pbq" selected>p | b, q</option>
					</select>

					<label class="w3-left w3-text-indigo">Cellsize:</label>
					<select class="w3-select w3-margin-bottom" id="select_cellsize" onchange="doOnChangeCellsize();" disabled>
						<option value="40" selected>40 pixel</option>
						<option value="60">60 pixel</option>
						<option value="80">80 pixel</option>
					</select>

					<div class="w3-display-container w3-padding">&nbsp;
						<div class="w3-display-left">
							<input class="w3-check" type="checkbox" checked="checked" id="chk_highlight" onchange="doOnChangeHighlight();"><label class="w3-text-indigo">&nbsp;Higlight</label>
						</div>
					</div>

					<div class="w3-display-container w3-padding">&nbsp;
						<button id="thebutton" class="w3-display-right w3-button w3-theme-l1 w3-hover-blue w3-round w3-margin-bottom" onclick="doTest();">Generate</button>
					</div>

					<div id="placeofthemessage">&nbsp;</div>

				</div>

			</div>

			<!--		<div class="w3-col s12 m8 l10 w3-center w3-padding" style="width:600px;" id="id_cell_container">-->
			<div class="w3-col s12 m8 l6 w3-center w3-padding" id="id_cell_container">

				<div id="placeofthematrix" class="w3-card-4 w3-theme-l2 w3-padding w3-round-large">
				</div>

			</div>


			<div class="w3-col s12 m8 l4 w3-center w3-padding" id="id_cell_container">

				<!--<div id="pdfpreview" class="w3-card-4 w3-theme-l2 w3-padding w3-round-large"></div>-->
				<div id="pdfpreview" style="height: 700px;"></div>

			</div>

		</div>

	</div>

	<div class="w3-container" id="id-footer-placeholder">
		<p>&nbsp;</p>
	</div>


	<footer class="w3-container w3-theme-l3 w3-bottom" id="id-footer">
		<p>Footer</p>
	</footer>


</body>

</html>